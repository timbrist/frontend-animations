<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&display=swap" rel="stylesheet">
  <title>Storyline Animation</title>
  <style>
  * { box-sizing: border-box; }
  body { background: #000; font-family: "DM Serif Display", ui-serif, Georgia, "Times New Roman", serif; margin: 0; }
  h1, p { color: white; font-weight: 400; text-align: center; margin: 0; }
  /* .story { border: 1px solid white; } */
  .story.pin-section {
    width: 100% !important;
    height: 90vh;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 4rem 6vw 8px !important;
    left: 0 !important;
    right: 0 !important;
  }
  .pin-content {
    width: 100%;
    max-width: 1200px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 20px;
    position: relative;
  }
  .story-continuation {
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0 6vw 4rem;
    min-height: 100vh;
    gap: 20px;
  }
  .story-content, .feature-story, .feature-story2 {
    background: rgba(0, 0, 0, 0.5);
    padding: 20px;
    opacity: 0;
  }
  .feature-story2 { margin-bottom: 50px; }
  .drawing-line { width: 100px; height: 400px; }
  .drawing-curve { width: 200px; height: 400px; margin-bottom: 50px; }
  .section--a, .section--c { 
    height: 100vh; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    padding: 4rem 6vw; 
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>
</head>
<body>
  <main>
    <section class="section--a"><h1>1st Screen Section</h1></section>
    
    <section class="story pin-section">
      <div class="pin-content">
        <div class="story-content">
          <h1>Story1</h1>
          <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Quisquam, quos.</p>
        </div>
        <div class="drawing-line">
          <svg width="100" height="400" viewBox="0 0 100 400">
            <path id="line-path" d="M 50 0 L 50 400" stroke="white" stroke-width="2" fill="none"/>
          </svg>
        </div>
        <div class="feature-story">
          <h1>Story2</h1>
          <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Quisquam, quos.</p>
        </div>
      </div>
    </section>

    <section class="story-continuation">
      <div class="drawing-curve">
        <svg width="200" height="400" viewBox="0 0 200 400">
          <path id="curve" d="M150 0 C150 200 50 200 50 400" stroke="white" stroke-width="2" fill="none"/>
        </svg>
      </div>
      <div class="feature-story2">
        <h1>Story3</h1>
        <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Quisquam, quos.</p>
      </div>
    </section>

    <section class="section--c"><h1>3rd Screen Section</h1></section>
  </main>
  <script>
gsap.registerPlugin(ScrollTrigger);

// Global Debug Toggle
const DEBUG_MODE = false; 

const markerStyle = DEBUG_MODE ? { startColor: "#fff", endColor: "#FFBF00", fontSize: "16px", indent: 300 } : false;

(function() {
  // step 1: pin the section.
  ScrollTrigger.create({
    trigger: ".story.pin-section",
    start: "top top",
    end: "+=200%",
    pin: true,
    pinSpacing: true,
    anticipatePin: 1,
    pinType: "fixed",
    invalidateOnRefresh: false,
    markers: markerStyle
  });

  // Step 2: Create the animation timeline.
  const tl = gsap.timeline({
    scrollTrigger: {
      trigger: ".story.pin-section",
      start: "top top",
      end: "+=200%",
      scrub: true,
      invalidateOnRefresh: false,
      markers: DEBUG_MODE ? { ...markerStyle, indent: 150 } : false
    }
  });


  // Step 3: the first element appears.
  tl.fromTo(".story-content", { opacity: 0, y: 50 }, { opacity: 1, y: 0, duration: 0.3, ease: "power1.out" }, 0);
  
  // Step 4: Draw the straight line when user scrolls to the pinned section.
  const linePath = document.getElementById('line-path');
  if (linePath) {
    const len = linePath.getTotalLength();
    gsap.set(linePath, { strokeDasharray: len, strokeDashoffset: len });
    tl.to(linePath, { strokeDashoffset: 0, duration: 0.4, ease: "none" }, 0.3);
  }

  // Step 5: the 3rd element appears.
  tl.fromTo(".feature-story", { opacity: 0, y: 50 }, { opacity: 1, y: 0, duration: 0.3, ease: "power1.out" }, 0.7);

  // Step 6: End of the pinned section, start to draw the curve.
  const curvePath = document.getElementById('curve');
  if (curvePath) {
    const len = curvePath.getTotalLength();
    gsap.set(curvePath, { strokeDasharray: len, strokeDashoffset: len });
    gsap.to(curvePath, {
      strokeDashoffset: 0,
      scrollTrigger: {
        trigger: ".drawing-curve",
        start: "top 80%",
        end: "bottom 20%",
        scrub: 1,
        markers: DEBUG_MODE
      }
    });
  }

  // Step 7: the last element appears.
  gsap.fromTo(".feature-story2",
    { opacity: 0, y: 50 },
    { 
      opacity: 1, 
      y: 0,
      scrollTrigger: {
        trigger: ".drawing-curve",
        start: "center center",
        end: "bottom 30%",
        scrub: 1,
        markers: DEBUG_MODE
      }
    }
  );
})();
  </script>
</body>
</html>